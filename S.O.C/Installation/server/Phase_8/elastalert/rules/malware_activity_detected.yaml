es_host: elasticsearch
es_port: 9200
es_username: elastic
es_password: elastic
type: any
is_enabled: true
doc_type: doc

alert:
  - hivealerter

hivealerter:
hive_connection:
   hive_host: http://thehive
   hive_port: 9000
   hive_apikey: <replace_with_thehive_user_token>

hive_alert_config:
   type: 'external'
   source: 'elastalert'
   severity: 2
   tags: ["suricata_"]
   tlp: 3
   status: 'New'
   follow: True

hive_observable_data_mapping:
   - ip: source.ip
   
alert_subject: "{} | <{}>"
alert_subject_args:
  - suricata.eve.alert.signature
  - source.ip

alert_text: |-
  Type of attack: {}
  Source IP: {}
  Destination IP: {}
alert_text_args:
  - suricata.eve.alert.signature
  - source.ip
  - destination.ip

filter:
  - query:
      query_string:
        query: "event.kind:alert"

include:
  - suricata.eve.alert.signature
  - source.ip
  - destination.ip

alert_text_type: alert_text_only
name: Malware Activity Detected
index: filebeat-*
num_events: 1
realert:
  minutes: 0
